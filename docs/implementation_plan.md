# План выполнения тестового задания (2–3 дня)

## Цель к дедлайну

К **27 числа, 21:00** должно быть готово:

- backend + БД + миграции + воркер парсинга;
- SPA (login + таблица машин);
- Telegram-бот с разбором запроса через Function Calling;
- запуск одной командой `docker compose up --build`;
- README с инструкцией, архитектурой и кредами.

---

## День 1 — фундамент (6–10 часов)

### 1) Базовая инфраструктура

- [x] Создать структуру монорепо: `backend`, `frontend`, `worker`, `bot`, `docs`.
- [x] Добавить `docker-compose.yml`, `.env.example`.
- [ ] Подготовить Dockerfile для frontend/worker/bot.

### 2) Backend core

- [x] Поднять FastAPI-приложение.
- [x] Реализовать `POST /api/login` (JWT).
- [x] Реализовать `GET /api/cars` с JWT-защитой.
- [ ] Подключить SQLAlchemy + PostgreSQL полноценно.
- [ ] Добавить Alembic + первую миграцию.
- [ ] Сделать сидинг дефолтного администратора.

### 3) Definition of Done за День 1

- локально поднимается backend + db;
- login и защищённый endpoint отвечают корректно;
- есть первый осмысленный коммит с каркасом.

---

## День 2 — данные и пользовательский интерфейс (8–12 часов)

### 1) Воркер/сбор данных

- [ ] Интеграция с API carsensor.net.
- [ ] Нормализация полей: марка, модель, год, цена, цвет, ссылка.
- [ ] Upsert-логика (новые + обновление изменившихся).
- [ ] Retry при сетевых ошибках (экспоненциальный backoff).
- [ ] Периодический запуск (scheduler/loop).

### 2) Frontend (SPA)

- [ ] `/login`: форма входа, хранение JWT.
- [ ] `/`: защищённый маршрут, таблица машин.
- [ ] Базовая обработка ошибок/лоадера.

### 3) Definition of Done за День 2

- в БД появляются реальные объявления;
- фронтенд логинится и показывает список авто;
- upsert работает на повторных прогонах воркера.

---

## День 3 — Telegram-бот, упаковка и сдача (6–10 часов)

### 1) Telegram-бот

- [ ] Интеграция aiogram.
- [ ] LLM Function Calling для извлечения фильтров из естественного языка.
- [ ] SQL-фильтрация в БД и читаемый ответ пользователю.
- [ ] Fallback без фильтров/при невалидном запросе.

### 2) Финализация

- [ ] Smoke-тест всего стека в Docker Compose.
- [ ] Обновить README (архитектура, запуск, env, креды).
- [ ] Проверить `.env.example` и секреты.
- [ ] Подготовить демо-сценарий и финальный check-list.

### 3) Буфер риска (2–3 часа)

- проблемы с API carsensor;
- проблемы с LLM-ключом/лимитами;
- багфиксы перед сабмитом.

---

## Приоритизация (если время поджимает)

1. Backend + воркер + upsert + JWT API.
2. Простой, но рабочий frontend (минимальный UI).
3. Telegram-бот с базовым Function Calling.
4. Полировка интерфейса и расширенные фичи.

